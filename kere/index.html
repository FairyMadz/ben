<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interaksi Kolom</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
    }

    header {
      background: #007BFF;
      color: white;
      padding: 20px;
      text-align: center;
    }

    footer {
      background: #343A40;
      color: white;
      padding: 10px;
      text-align: center;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      padding: 20px;
      gap: 20px;
    }

    .column {
      flex: 1;
      min-width: 300px;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .left {
      background: #F8F9FA;
    }

    .right {
      background: #E9ECEF;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    ul li {
      padding: 10px;
      margin: 5px 0;
      background: #007BFF;
      color: white;
      cursor: pointer;
      border-radius: 5px;
      text-align: center;
    }

    ul li:hover {
      background: #0056b3;
    }

    .data-display {
      font-size: 16px;
      color: #333;
    }
  </style>
</head>
<body>
  <header>
    <h1>Aplikasi Interaksi Kolom</h1>
  </header>

  <div class="container">
    <div class="column left">
      <h2>Daftar List</h2>
      <ul id="itemList"></ul>
    </div>
    <div class="column right">
      <h2>Data Detail</h2>
      <div id="dataDisplay" class="data-display"></div>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 Aplikasi Interaksi Kolom. Semua Hak Dilindungi.</p>
  </footer>

  <script>
    // Data list dan detailnya
    const items = [
      { id: 1, name: "List 1", description: "<hr/><br>
      » ISP         : ${isp}<br>
      » Country     :${id}&nbsp;<span class="flag-icon flag-icon-${id.toLowerCase()}"></span><br>
      » IP:PORT      : ${ip}-${port}<br>
      <hr/>VLESS PATH SIMPLE<br>
      PATH: /${id}${cons}<br>
       vless://${uuidv4()}@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${id}${cons}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}
      <button class="copy-vless">COPY VLESS SIMPLE</button>
      <br><hr/>VLESS PATH RIBET<br>
      PATH: /${ip}-${port}<br><button class="copy-vless-clash">COPY VLESS RIBET</button>
      <hr/>
      <hr/>TROJAN PATH SIMPLE<br>
      PATH: /${id}${cons}<br>
      <button class="copy-trojan">COPY TROJAN SIMPLE</button>
      <br><hr/>TROJAN PATH RIBET<br>
      PATH: /${ip}-${port}<br><button class="copy-trojan-clash877">COPY RIBET RIBET</button> 
      <hr/>
      <hr/>SHADOWSOCK PATH SIMPLE<br>
      PATH: /${id}${cons}<br>
      <button class="copy-ss">COPY SHADOWSOCK SIMPLE</button>
      <br><hr/>SHADOWSOCK PATH RIBET<br>
      PATH: /${ip}-${port}<br>
      <button class="copy-ss1">COPY SHADOWSOCK RIBET</button>
     <hr/> " },
      { id: 2, name: "List 2", description: "Ini adalah detail untuk List 2." },
      { id: 3, name: "List 3", description: "Ini adalah detail untuk List 3." },
      { id: 4, name: "List 4", description: "Ini adalah detail untuk List 4." },
      { id: 5, name: "List 5", description: "Ini adalah detail untuk List 5." },
    ];

    // Elemen HTML
    const itemList = document.getElementById('itemList');
    const dataDisplay = document.getElementById('dataDisplay');

    // Fungsi untuk menampilkan data di kolom kanan
    const showData = (id) => {
      const selectedItem = items.find(item => item.id === id);
      dataDisplay.textContent = selectedItem ? selectedItem.description : "Data tidak ditemukan.";
    };

    // Generate daftar list di kolom kiri
    items.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item.name;
      li.dataset.id = item.id;
      itemList.appendChild(li);

      // Tambahkan event listener untuk klik
      li.addEventListener('click', () => showData(item.id));
    });

    // Tampilkan data untuk item pertama saat halaman dimuat
    showData(items[0].id);


    function uuidv4() {
  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
  );
}

  // URL untuk mendapatkan proxy list
  fetch("https://cf.cepu.us.kg/update_proxyip.txt")
    .then(response => response.text())
    .then(data => {
      const allProxies = data.split("\n").filter(line => line.trim() !== "");
    let filteredProxies = [...allProxies]; // Salin array asli untuk filtering
    const proxyList = document.getElementById('proxy-list');
    const pagination = document.getElementById('pagination');
    const perPageSelect = document.getElementById('items-per-page');
    const searchInput = document.getElementById('search-bar');
    const totalProxyElement = document.getElementById('total-proxy');
    const filteredProxyElement = document.getElementById('filtered-proxy');

    // Tampilkan total proxy keseluruhan
    totalProxyElement.innerHTML = ` `;

    // Fungsi untuk memperbarui jumlah proxy yang difilter dan menampilkan ID serta bendera
    const updateFilteredProxies = () => {
      const id = filteredProxies.length > 0 ? filteredProxies[0].split(',')[2] : ''; // Ambil ID dari proxy pertama, asumsikan format 'ip,port,id,isp'
      filteredProxyElement.innerHTML = `
        <strong>Total Proxy :</strong> ${filteredProxies.length} dari <strong>${allProxies.length}</strong>
      `;
    };

    // Fungsi untuk menampilkan bendera negara
    updateFilteredProxies();
    let itemsPerPage = parseInt(perPageSelect.value, 15);

      // Fungsi untuk memperbarui jumlah item per halaman
      perPageSelect.addEventListener('change', () => {
        itemsPerPage = parseInt(perPageSelect.value, 15);
        renderProxies(filteredProxies, proxyList, pagination, itemsPerPage);
      });
    // Panggil fungsi untuk menampilkan bendera dan proxy
    
    
    // Fungsi untuk pencarian
    searchInput.addEventListener('input', () => {
      const query = searchInput.value.toLowerCase();
      filteredProxies = allProxies.filter(proxy => {
        const [ip, port, id, isp] = proxy.split(',');
        return id.toLowerCase().includes(query);
      });
      updateFilteredProxies(); // Update jumlah proxy setelah pencarian
      renderProxies(filteredProxies, proxyList, pagination, itemsPerPage);
 // Render proxy yang telah difilter
    });

    // Render proxies dengan pagination
    renderProxies(filteredProxies, proxyList, pagination, itemsPerPage);

  })
  .catch(error => console.error("Error fetching proxy data:", error));

  // Fungsi untuk mengecek status proxy
  function checkProxyStatus(ip, port, statusElement) {
  // Menampilkan indikator loading saat memeriksa status
  statusElement.innerHTML = '<strong><i class="fas fa-spinner fa-spin loading-icon"></i>Loading...</strong>';
  statusElement.style.color = 'green';
    
  const startTime = performance.now(); // Mencatat waktu awal
  const StatusURL = `https://ns1.bmkg.xyz/check?target=${ip}:${port}`;

  // Mengambil data dari API untuk memeriksa status proxy
  fetch(StatusURL)
    .then(response => response.json())
    .then(data => {
      const endTime = performance.now(); // Mencatat waktu akhir
      let latency = endTime - startTime; // Menghitung latency dalam ms

      // Memperkecil nilai latency, misalnya dibagi dengan 10
      latency = latency / 5; // Faktor pembagi untuk memperkecil nilai latency

      // Membuang bagian setelah desimal, hanya menyisakan nilai integer
      const latencyString = Math.floor(latency); // Hanya ambil angka bulat (membuang bagian desimal)

      // Memeriksa status proxy dan menampilkannya sesuai dengan status
      if (data.proxyip) {
        // Proxy status aktif
        statusElement.innerHTML = `
          <strong><i class="fas fa-bolt"></i>&nbsp;<span style="color: gold;">${latencyString}ms</span></strong>
        `;
        statusElement.style.color = 'green';
      } else {
        // Proxy status mati
        statusElement.innerHTML = `
          <strong><i class="fas fa-times-circle"></i> DEAD</strong>
        `;
        statusElement.style.color = 'red';
      }
    })
    .catch(() => {
      // Menangani kesalahan jika API tidak merespon atau terjadi masalah jaringan
      statusElement.innerHTML = `
        <strong><i class="fas fa-exclamation-triangle"></i> Error</strong>
      `;
      statusElement.style.color = 'cyan';
    });
}



  // Fungsi untuk render proxies dengan pagination
  function renderProxies(proxies, proxyList, pagination, itemsPerPage) {
    const totalPages = Math.ceil(proxies.length / itemsPerPage);
    let currentPage = 1;


   const countryCounter = {}; // Move this line outside of the renderProxies function to persist counts


    function updatePage(page) {
      if (page < 1 || page > totalPages) return;
      currentPage = page;

      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageProxies = proxies.slice(start, end);

      // Clear existing proxy list
      proxyList.innerHTML = '';

      // Render proxies for the current page
      pageProxies.forEach(proxy => {
        const [ip, port, id, isp] = proxy.split(','); // Split the proxy data into individual parts
        
        
        // Increment counter for country
            if (!countryCounter[id]) {
                countryCounter[id] = 0;
            }
            countryCounter[id]++;
            const cons = countryCounter[id]; // Use the country counter

        
        // Set placeholder values (you can modify this to extract from proxy data if available)
        const wildcard = '';
        const vlessTls = '';
        const troranTls = '';
        const shadowsocks = '';

        // Create a row with innerHTML to make it more manageable
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><div class="flag-container">
            <span>${isp} || ${id}</span>
            <span class="flag-circle flag-icon flag-icon-${id.toLowerCase()}"></span>
            </div></td>
          <td>
            <span id="status-${ip}-${port}"><div class="rainbow-text">LOADING...</div></span>
          </td>
          <td><select class="service-selector">
          <option value="">NO WILDCARD</option>
          <option value="business.blibli.com">business.blibli.com</option>          
          <option value="ava.game.naver.com">ava.game.naver.com</option>
          <option value="graph.instagram.com">graph.instagram.com</option>
          <option value="quiz.int.vidio.com">quiz.int.vidio.com</option>
          <option value="live.iflix.com.com">live.iflix.com</option>
          <option value="support.zoom.us">support.zoom.us</option>
          <option value="blog.webex.com">blog.webex.com</option>
          <option value="investors.spotify.com">investors.spotify.com</option>
          <option value="cache.netflix.com">cache.netflix.com</option>
          <option value="zaintest.vuclip.com">zaintest.vuclip.com</option>
          <option value="ads.ruangguru.com">io.ruangguru.com</option>
          <option value="api.midtrans.com">api.midtrans.com</option>
        </select></td>
          <td><button class="button1" onclick="showPopup('vtls${ip}-${port}')">VLESS TLS 443</button>
      <div class="popup" id="vtls${ip}-${port}">
      <div class="popup-content"><hr/><br>
      » ISP         : ${isp}<br>
      » Country     :${id}&nbsp;<span class="flag-icon flag-icon-${id.toLowerCase()}"></span><br>
      » IP:PORT      : ${ip}-${port}<br>
      
      <button class="button8" onclick="hidePopup('vtls${ip}-${port}')">Close</button> 
</div>
</div></td>
          <td><button class="button2" onclick="showPopup('trojan${ip}-${port}')">TROJAN TLS 443</button>
      <div class="popup" id="trojan${ip}-${port}">
      <div class="popup-content">
      
      
      <button class="button8" onclick="hidePopup('trojan${ip}-${port}')">Close</button> 
    </div>
    </div></td>
          <td><button class="button3" onclick="showPopup('ss${ip}-${port}')">SHADOWSOCK</button>
      <div class="popup" id="ss${ip}-${port}">
      <div class="popup-content"><hr/><br>
      » ISP         : ${isp}<br>
      » Country     :${id}&nbsp;<span class="flag-icon flag-icon-${id.toLowerCase()}"></span><br>
      » IP:PORT      : ${ip}-${port}<br>
      
      <button class="button8" onclick="hidePopup('ss${ip}-${port}')">Close</button> 
    </div>
    </div></td>
        `;

        // Append the row to the proxy list
        proxyList.appendChild(row);

        row.querySelector('.copy-vless').addEventListener('click', () => {
    const host = "tedjo.cepu.us.kg";
const selectedService = row.querySelector('.service-selector').value || host;
const domain = selectedService === host ? host : `${selectedService}.${host}`;
    const VLESS = `vless://${uuidv4()}@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${id}${cons}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}`;
    navigator.clipboard.writeText(VLESS);
    Swal.fire({
      title: 'Berhasil!',
      text: 'COPY VLESS SIMPLE SUKSES!',
      icon: 'success',
      background: 'rgba(6, 18, 67, 0.89)', // Warna latar belakang (biru pucat)
      color: 'red', // Warna teks
      customClass: {
        popup: 'rounded-popup',
      },
      confirmButtonColor: '#3085d6'
    });
});

row.querySelector('.copy-vless-clash').addEventListener('click', () => {
    const host = "tedjo.cepu.us.kg";
const selectedService = row.querySelector('.service-selector').value || host;
const domain = selectedService === host ? host : `${selectedService}.${host}`;
    const VLESSC = `vless://${uuidv4()}@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${ip}-${port}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}`;
  navigator.clipboard.writeText(VLESSC);
    Swal.fire({
      title: 'Berhasil!',
      text: 'COPY VLESS RIBET SUKSES!',
      icon: 'success',
      background: 'rgba(6, 18, 67, 0.89)', // Warna latar belakang (biru pucat)
      color: 'red', // Warna teks
      customClass: {
        popup: 'rounded-popup',
      },
      confirmButtonColor: '#3085d6'
    });
});

row.querySelector('.copy-trojan').addEventListener('click', () => {
    const host = "tedjo.cepu.us.kg";
const selectedService = row.querySelector('.service-selector').value || host;
const domain = selectedService === host ? host : `${selectedService}.${host}`;
    const TROJAN = `trojan://${uuidv4()}@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${id}${cons}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}`;
    navigator.clipboard.writeText(TROJAN);
    Swal.fire({
      title: 'Berhasil!',
      text: 'COPY TROJAN SIMPLE SUKSES!',
      icon: 'success',
      background: 'rgba(6, 18, 67, 0.89)', // Warna latar belakang (biru pucat)
      color: 'red', // Warna teks
      customClass: {
        popup: 'rounded-popup',
      },
      confirmButtonColor: '#3085d6'
    });
});

row.querySelector('.copy-trojan-clash877').addEventListener('click', () => {
    const selectedService = row.querySelector('.service-selector').value || "xvp.bmkg.xyz";
    const host = "tedjo.cepu.us.kg";
    const domain = selectedService === host ? host : `${selectedService}.${host}`;
    const TROJANC877 = `trojan://${uuidv4()}@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${ip}-${port}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}`;
    
    navigator.clipboard.writeText(TROJANC877);
    Swal.fire({
      title: 'Berhasil!',
      text: 'COPY TROJAN RIBET SUKSES!',
      icon: 'success',
      background: 'rgba(6, 18, 67, 0.89)', // Warna latar belakang (biru pucat)
      color: 'red', // Warna teks
      customClass: {
        popup: 'rounded-popup',
      },
      confirmButtonColor: '#3085d6'
    });
});

row.querySelector('.copy-ss').addEventListener('click', () => {
    const host = "tedjo.cepu.us.kg";
const selectedService = row.querySelector('.service-selector').value || host;
const domain = selectedService === host ? host : `${selectedService}.${host}`;
    const SS = `ss://bm9uZTo1ZDJlYmQyYS05Y2I5LTRkMWItYWY1NS04NjE3ZDNlODFmMzk%3D@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${id}${cons}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}`;
    navigator.clipboard.writeText(SS);
    Swal.fire({
      title: 'Berhasil!',
      text: 'COPY SHADOWSOCK SIMPLE SUKSES!',
      icon: 'success',
      background: 'rgba(6, 18, 67, 0.89)', // Warna latar belakang (biru pucat)
      color: 'red', // Warna teks
      customClass: {
        popup: 'rounded-popup',
      },
      confirmButtonColor: '#3085d6'
    });
});

row.querySelector('.copy-ss1').addEventListener('click', () => {
    const host = "tedjo.cepu.us.kg";
const selectedService = row.querySelector('.service-selector').value || host;
const domain = selectedService === host ? host : `${selectedService}.${host}`;
    const SS1 = `ss://bm9uZTo1ZDJlYmQyYS05Y2I5LTRkMWItYWY1NS04NjE3ZDNlODFmMzk%3D@${selectedService}:443?encryption=none&type=ws&host=${domain}&path=%2F${ip}-${port}&security=tls&sni=${domain}#(${selectedService})+${id}+${isp}`;
    navigator.clipboard.writeText(SS1);
    Swal.fire({
      title: 'Berhasil!',
      text: 'COPY SHADOWSOCK RIBET SUKSES!',
      icon: 'success',
      background: 'rgba(6, 18, 67, 0.89)', // Warna latar belakang (biru pucat)
      color: 'red', // Warna teks
      customClass: {
        popup: 'rounded-popup',
      },
      confirmButtonColor: '#3085d6'
    });
});
        
        
        // Update status as per your logic
        checkProxyStatus(ip, port, document.getElementById(`status-${ip}-${port}`));
      });

      // Update pagination buttons
      updatePagination();
    }

    // Update pagination buttons
    function updatePagination() {
      pagination.innerHTML = ''; // Clear existing pagination

      // Create previous button
      const prevButton = document.createElement('button');
      prevButton.textContent = '◁';
      prevButton.onclick = () => updatePage(currentPage - 1);
      pagination.appendChild(prevButton);

      // Create first page button (<<<)
      const firstButton = document.createElement('button');
      firstButton.textContent = 'first';
      firstButton.onclick = () => updatePage(1);
      pagination.appendChild(firstButton);

      // Create page number buttons (limited to 5 pages)
      const startPage = Math.max(1, currentPage - 2);
      const endPage = Math.min(totalPages, currentPage + 2);
      for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.textContent = i;
        pageButton.onclick = () => updatePage(i);
        if (i === currentPage) pageButton.style.fontWeight = 'bold'; // Highlight current page
        pagination.appendChild(pageButton);
      }

      // Create last page button (>>>)
      const lastButton = document.createElement('button');
      lastButton.textContent = 'last';
      lastButton.onclick = () => updatePage(totalPages);
      pagination.appendChild(lastButton);

      // Create next button
      const nextButton = document.createElement('button');
      nextButton.textContent = '▷';
      nextButton.onclick = () => updatePage(currentPage + 1);
      pagination.appendChild(nextButton);
    }

    // Initialize the page with the first set of proxies
    updatePage(1);
  }


  </script>
</body>
</html>
